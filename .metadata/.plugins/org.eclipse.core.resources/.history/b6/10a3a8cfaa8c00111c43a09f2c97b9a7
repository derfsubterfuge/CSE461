package edu.uw.cs.cse461.sp12.OS;

import java.io.IOException;
import java.util.Properties;

import edu.uw.cs.cse461.sp12.OS.NameManagerBase.RecordSet;
import edu.uw.cs.cse461.sp12.util.NanoHTTPD;

public class DDNSServiceHTTPD extends NanoHTTPD {
	
	private NameManager mManager;
	
	public DDNSServiceHTTPD( int port, NameManager manager ) throws IOException {
		super(port, null); // don't want to serve files, ever (?)

		mManager = manager;
	}

	@Override
	public Response serve( String uri, String method, Properties header, Properties parms, Properties files ) {
		try {
			RecordSet fullSet = mManager.read();
			Response response = new Response();

			
			StringBuilder sb = new StringBuilder("<html><body>");
			sb.append("Test message");
			sb.append("</body></html>");
			
			return new Response( HTTP_OK, MIME_HTML, sb.toString() );
			
		} catch (Exception e) {
			return new Response( HTTP_INTERNALERROR, MIME_PLAINTEXT, HTTP_INTERNALERROR + "<p><pre>" + e.getMessage() + "</pre>");
		}
		return null;
	}


}
