package edu.uw.cs.cse461.ConsoleApps;

import edu.uw.cs.cse461.Net.Base.NetBase;
import edu.uw.cs.cse461.Net.Base.NetLoadable.NetLoadableConsoleApp;
import edu.uw.cs.cse461.Net.DDNS.DDNSFullName;
import edu.uw.cs.cse461.Net.DDNS.DDNSRRecord;
import edu.uw.cs.cse461.Net.DDNS.DDNSResolverService;
import edu.uw.cs.cse461.util.Log;

public class DDNSSimpleTest extends NetLoadableConsoleApp {
	private static final String TAG="DDNSSimpleTest";

	// ConsoleApp's must have a public constructor taking no arguments
	public DDNSSimpleTest() {
		super("ddnssimpletest", true);
	}
	
	@Override
	public void run() {
		NetBase theNetBase = NetBase.theNetBase();
		try {
			DDNSResolverService resolver = (DDNSResolverService)theNetBase.getService("ddnsresolver");
			if ( resolver == null ) {
				Log.e(TAG, "No ddnsresolver service loaded");
				return;
			}
			Log.e(TAG, resolver.toString());

			// Resolve a host
			DDNSRRecord testAddress = resolver.resolve(theNetBase.hostname());
			Log.e(TAG, testAddress.toString());

			testAddress = resolver.resolve(theNetBase.hostname());
			Log.e(TAG, testAddress.toString());
			
			testAddress = resolver.resolve("");
			Log.e(TAG, testAddress.toString());

			testAddress = resolver.resolve(new DDNSFullName(theNetBase.hostname()).parent().toString());
			Log.e(TAG, testAddress.toString());

			testAddress = resolver.resolve("foo.jz.cse461");
			Log.e(TAG, testAddress.toString());

			testAddress = resolver.resolve("foo.cse461");
			Log.e(TAG, testAddress.toString());
		} catch (Exception e) {
			System.out.println("DDNSSimpleTest.run() caught exception: " +e.getMessage());
		}
	}
	
	@Override
	public void shutdown() {
	}
}
